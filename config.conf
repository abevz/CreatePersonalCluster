# =============================================================================
# CPC (Cluster Provision & Configure) - Configuration
# =============================================================================
# Extracted from main cpc script for modular architecture
# This file contains global configuration variables and settings

# --- Core Configuration ---
CPC_ENV_FILE="cpc.env"
CPC_CONTEXT_FILE=".cluster_context"
REPO_PATH=""  # Will be set dynamically by setup-cpc

# --- Color definitions for output ---
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
WHITE='\033[1;37m'
ENDCOLOR='\033[0m'

# --- Default values ---
DEFAULT_PROXMOX_NODE="homelab"
DEFAULT_STORAGE="MyStorage"
DEFAULT_NETWORK_BRIDGE="vmbr0"

# --- Terraform/OpenTofu configuration ---
TF_STATE_BACKEND="s3"
TF_STATE_BUCKET="terraform-state"

# --- Ansible configuration ---
ANSIBLE_INVENTORY_PATH="ansible/inventory"
ANSIBLE_PLAYBOOKS_PATH="ansible/playbooks"

# --- SSH configuration ---
SSH_KNOWN_HOSTS_FILE="$HOME/.ssh/known_hosts"
SSH_CONFIG_FILE="$HOME/.ssh/config"

# --- Kubernetes configuration ---
KUBECONFIG_DEFAULT="$HOME/.kube/config"

# --- Pi-hole DNS configuration ---
PIHOLE_API_ENDPOINTS=(
    "/admin/api.php"
    "/api.php" 
    "/admin/scripts/pi-hole/php/api.php"
)

# --- Validation patterns ---
WORKSPACE_NAME_PATTERN="^[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]$"
RELEASE_LETTER_PATTERN="^[a-zA-Z]$"
IP_ADDRESS_PATTERN="^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$"

# --- File paths ---
TERRAFORM_DIR="terraform"
ENVIRONMENTS_DIR="envs"
DOCS_DIR="docs"
SCRIPTS_DIR="scripts"

# --- Error Handling Configuration ---
# Timeout values in seconds
command_timeout=300      # 5 minutes for general commands
network_timeout=30       # 30 seconds for network operations
ansible_timeout=1800     # 30 minutes for Ansible operations
kubectl_timeout=120      # 2 minutes for kubectl operations
terraform_timeout=3600   # 1 hour for Terraform/OpenTofu operations

# Retry configuration
max_retries=3
base_retry_delay=2
max_retry_delay=60
retry_backoff_multiplier=2

# Error handling severity levels
# CRITICAL: Stop execution immediately
# HIGH: Log error and continue with warnings
# MEDIUM: Log error and attempt recovery
# LOW: Log warning only
# INFO: Log info only
default_error_severity=MEDIUM

# Recovery configuration
enable_recovery=true
recovery_log_path="/tmp/cpc_recovery.log"
auto_rollback_on_failure=true

# --- Export commonly used variables ---
export CPC_ENV_FILE CPC_CONTEXT_FILE
export RED GREEN YELLOW BLUE PURPLE CYAN WHITE ENDCOLOR
